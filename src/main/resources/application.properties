# ============================================================================
# CONFIGURAZIONE PRINCIPALE DELL'APPLICAZIONE
# ============================================================================
# Questo file contiene tutte le configurazioni dell'applicazione Spring Boot.
# Le credenziali sensibili sono caricate dal file env.properties esterno
# per evitare di commettere dati sensibili nel controllo versione.
# ============================================================================

# Nome dell'applicazione Spring Boot
spring.application.name=Alex 

# ============================================================================
# IMPORT PROPRIETÀ AMBIENTE
# ============================================================================
# Importa le proprietà dal file env.properties nella directory root del progetto.
# 'optional:' significa che l'applicazione funzionerà anche se il file non esiste
# (utile per ambienti dove le variabili sono impostate tramite variabili d'ambiente).
# Le credenziali sensibili (database, JWT, Cloudinary, Mailgun) sono definite in env.properties
spring.config.import=optional:file:./env.properties

# ============================================================================
# PROFILO ATTIVO
# ============================================================================
# Definisce quale profilo Spring è attualmente attivo.
# - dev: ambiente di sviluppo (default, logging dettagliato, SQL visibile)
# - prod: ambiente di produzione (logging minimo, SQL nascosto, sicurezza massima)
# - test: ambiente di test (utilizzato automaticamente durante i test)
# 
# Per cambiare profilo, modifica questo valore o usa la variabile d'ambiente:
# export SPRING_PROFILES_ACTIVE=prod
spring.profiles.active=dev

# ============================================================================
# CONFIGURAZIONE DATABASE
# ============================================================================
# Le credenziali del database vengono caricate da env.properties per motivi di sicurezza.
# Le proprietà ${db.url}, ${db.username}, ${db.password} vengono sostituite con
# i valori definiti nel file env.properties.

# URL di connessione al database PostgreSQL
spring.datasource.url=${db.url}

# Username per l'autenticazione al database
spring.datasource.username=${db.username}

# Password per l'autenticazione al database
spring.datasource.password=${db.password}

# Driver JDBC per PostgreSQL
spring.datasource.driver-class-name=org.postgresql.Driver

# ============================================================================
# CONFIGURAZIONE JPA/HIBERNATE
# ============================================================================
# Configurazione per la gestione della persistenza dei dati tramite JPA/Hibernate.
#
# IMPORTANTE PER PRODUZIONE:
# - ddl-auto=update NON è raccomandato per la produzione!
# - Per produzione, usa: spring.jpa.hibernate.ddl-auto=validate
# - Implementa migrazioni database con Flyway o Liquibase invece di ddl-auto
#
# Opzioni ddl-auto:
# - create-drop: crea lo schema all'avvio e lo elimina alla chiusura (solo per test)
# - create: crea lo schema all'avvio e lo sovrascrive se esiste (solo per sviluppo)
# - update: aggiorna lo schema mantenendo i dati esistenti (solo per sviluppo)
# - validate: valida lo schema senza modificarlo (raccomandato per produzione)
# - none: non esegue alcuna operazione sullo schema

# Strategia di gestione DDL (Data Definition Language)
# ATTENZIONE: In produzione usare 'validate' e gestire le migrazioni con Flyway/Liquibase
spring.jpa.hibernate.ddl-auto=update

# Mostra le query SQL eseguite nel log (false in produzione per performance e sicurezza)
spring.jpa.show-sql=false

# Dialetto SQL: Hibernate rileva automaticamente il dialetto dal driver JDBC (PostgreSQL in questo caso)
# NON è necessario specificare hibernate.dialect esplicitamente (rimuove il warning HHH90000025)
# Se necessario, è possibile forzarlo con: spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# Formatta le query SQL nel log per una migliore leggibilità (disabilitato per performance)
spring.jpa.properties.hibernate.format_sql=false

# Mostra commenti SQL nel log (disabilitato per ridurre il rumore nei log)
spring.jpa.properties.hibernate.use_sql_comments=false

# Open Session in View: disabilitato per API REST (best practice)
# Mantiene la sessione JPA chiusa durante il rendering della risposta HTTP
# Questo previene problemi di performance e sessioni aperte troppo a lungo
# In applicazioni REST non serviamo viste server-side, quindi non serve tenere aperta la sessione
spring.jpa.open-in-view=false

# ============================================================================
# CONFIGURAZIONE JWT (JSON Web Token)
# ============================================================================
# Configurazione per l'autenticazione basata su token JWT.
# Le credenziali JWT vengono caricate da env.properties per motivi di sicurezza.

# Chiave segreta per firmare e verificare i token JWT (caricata da env.properties)
jwt.secret=${jwt.secret}

# Durata di validità del token JWT in millisecondi
# 86400000 ms = 24 ore = 1 giorno
jwt.expiration=86400000

# ============================================================================
# CONFIGURAZIONE CLOUDINARY (API di terze parti per upload immagini)
# ============================================================================
# Cloudinary è utilizzato per gestire l'upload e lo storage delle immagini di profilo.
# Le credenziali vengono caricate da env.properties per motivi di sicurezza.
# Dashboard: https://cloudinary.com/console

# Nome del cloud Cloudinary
cloudinary.cloud-name=${cloudinary.cloud-name}

# Chiave API pubblica Cloudinary
cloudinary.api-key=${cloudinary.api-key}

# Chiave API segreta Cloudinary
cloudinary.api-secret=${cloudinary.api-secret}

# ============================================================================
# CONFIGURAZIONE MAILGUN (API di terze parti per notifiche email)
# ============================================================================
# Mailgun è utilizzato per inviare email di benvenuto, notifiche contratti,
# promemoria pagamenti e conferme manutenzioni.
# Le credenziali vengono caricate da env.properties per motivi di sicurezza.
# Dashboard: https://app.mailgun.com/

# Chiave API Mailgun per l'autenticazione
mailgun.api-key=${mailgun.api-key}

# Dominio Mailgun verificato utilizzato per l'invio delle email
mailgun.domain=${mailgun.domain}

# Indirizzo email mittente per tutte le notifiche inviate dall'applicazione
mailgun.from-email=${mailgun.from-email}

# ============================================================================
# CONFIGURAZIONE UPLOAD FILE
# ============================================================================
# Limiti per l'upload di file (principalmente immagini di profilo).
# Questi valori definiscono la dimensione massima consentita per i file caricati.

# Dimensione massima consentita per un singolo file
spring.servlet.multipart.max-file-size=10MB

# Dimensione massima consentita per l'intera richiesta (utile se si caricano più file)
spring.servlet.multipart.max-request-size=10MB

# ============================================================================
# CONFIGURAZIONE GRAPHQL
# ============================================================================
# Configurazione per l'endpoint GraphQL dell'applicazione.

# Abilita l'introspezione dello schema GraphQL (consente ai client di interrogare lo schema)
spring.graphql.schema.introspection.enable=true

# Percorso HTTP dell'endpoint GraphQL (default: /graphql)
spring.graphql.http.path=/graphql

# Abilita GraphiQL, un'interfaccia web interattiva per testare le query GraphQL
# ATTENZIONE: Disabilitare in produzione per motivi di sicurezza!
spring.graphql.graphiql.enabled=true

# ============================================================================
# CONFIGURAZIONE SWAGGER/OPENAPI
# ============================================================================
# Configurazione per la documentazione API interattiva con Swagger UI.
# Swagger UI fornisce un'interfaccia web per esplorare e testare gli endpoint REST.

# Percorso per accedere alla documentazione API in formato JSON/YAML
springdoc.api-docs.path=/api-docs

# Percorso per accedere all'interfaccia Swagger UI
springdoc.swagger-ui.path=/swagger-ui.html

# Abilita Swagger UI
# ATTENZIONE: Considerare di disabilitare in produzione per motivi di sicurezza!
springdoc.swagger-ui.enabled=true

# ============================================================================
# CONFIGURAZIONE LOGGING
# ============================================================================
# Configurazione dei livelli di log per diverse parti dell'applicazione.
# I valori di default qui definiti possono essere sovrascritti dai profili specifici
# (application-dev.properties, application-prod.properties).

# Livello di log di default per tutti i logger (root)
logging.level.root=INFO

# Livello di log per il package dell'applicazione (DEBUG per vedere tutti i log dell'app)
logging.level.com.epicode.Progetto_Backend=DEBUG

# Livello di log per Spring Security (INFO per ridurre log verbosi di configurazione)
# Usa DEBUG solo quando necessario per debugging di autenticazione/autorizzazione
logging.level.org.springframework.security=INFO

# Logger specifici Spring Security per ridurre rumore:
# Disabilita i log di configurazione automatica di Spring Security (riduce il rumore)
logging.level.org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer=ERROR
# Riduce log verbosi dei filtri Spring Security
logging.level.org.springframework.security.web=WARN
# Riduce log di configurazione del SecurityFilterChain
logging.level.org.springframework.security.config.annotation.web.configuration=WARN

# Livello di log per Spring Web MVC (INFO per ridurre log verbosi di mapping e configurazione)
logging.level.org.springframework.web=INFO
# Riduce log di configurazione dei handler mapping
logging.level.org.springframework.web.servlet.mvc.method.annotation=WARN
# Riduce log di configurazione dei filtri web
logging.level.org.springframework.web.filter=WARN

# Mostra le query SQL eseguite da Hibernate (DEBUG per vedere tutte le query)
# NOTA: Genera molto output - disabilitare in produzione o quando non necessario
logging.level.org.hibernate.SQL=DEBUG

# Mostra i parametri passati alle query SQL (TRACE per vedere i valori dei parametri)
# NOTA: Genera ancora più output - disabilitare se non necessario per debugging
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# ============================================================================
# CONFIGURAZIONE CORS (Cross-Origin Resource Sharing)
# ============================================================================
# Configurazione per permettere richieste HTTP da origini diverse (frontend separato).
# Queste proprietà vengono lette da CorsConfig.java per configurare il filtro CORS.
#
# IMPORTANTE PER PRODUZIONE:
# - Sviluppo: permissivo (localhost per testare con frontend locale)
# - Produzione: restrittivo (solo domini specifici del frontend in produzione)

# Origini consentite per le richieste CORS (frontend React, Vue, Angular su porte comuni)
# Formato: lista separata da virgole di URL completi
cors.allowed-origins=http://localhost:3000,http://localhost:5173,http://localhost:4200,http://127.0.0.1:3000

# Metodi HTTP consentiti per le richieste CORS
cors.allowed-methods=GET,POST,PUT,DELETE,PATCH,OPTIONS

# Header HTTP consentiti nelle richieste CORS (* = tutti gli header)
cors.allowed-headers=*

# Permette l'invio di credenziali (cookie, header di autenticazione) nelle richieste CORS
cors.allow-credentials=true


